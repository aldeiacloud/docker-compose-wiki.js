# Compose para wiki-js - AldeiaCloud
# 3 services: mongoDB, wiki-js e nginw para configurar o certificado SSL
# Nao alterar o nomes dos services, apenas a porta 443 esta exposta.
version: '3'

services:
  mongo:
    image: mongo
    volumes:
    - "mongo-db:/data/db"
# mongo-db volume is created for data persistence

  wiki:
    build: ./wiki
    volumes:
    - "/Users/didier//wiki/repo:/var/wiki/repo:rw,z"
#    - "/data/docker/persistent/wiki/repo:/var/wiki/repo:rw,z"
# local git repository for wiki-js will be in /data/docker/persistent/wiki/repo
    environment:
    - WIKI_HOST=https://127.0.0.1:443 # Change hostname here if required
    - WIKI_ADMIN_EMAIL=admin@example.com
    depends_on:
      - "mongo"
      
  nginx:
    build: ./nginx
    ports:
    - "443:443"
    depends_on:
      - "wiki"

volumes:
  mongo-db:
